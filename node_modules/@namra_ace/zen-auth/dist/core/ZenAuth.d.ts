import { IStore } from '../interfaces/IStore';
export interface ZenAuthOptions {
    secret: string;
    store: IStore;
    sessionDuration: number;
    tokenDuration: string;
    smtp?: any;
}
export declare class ZenAuth {
    private options;
    private mailer;
    constructor(options: ZenAuthOptions);
    /**
     * LOGIN: Creates a session with Device Metadata
     * @param payload - The user data (must include 'id' or '_id')
     * @param req - Optional Express Request object to capture IP/User-Agent
     */
    login(payload: any, req?: any): Promise<{
        token: string;
        sessionId: string;
    }>;
    /**
     * AUTHORIZE: Validates token AND slides the session window.
     * Handles "Graceful Expiration" (allows expired token if session is valid).
     */
    authorize(token: string): Promise<{
        valid: boolean;
        sessionId: string;
        user: any;
        error?: undefined;
    } | {
        valid: boolean;
        error: any;
    }>;
    /**
     * Helper to check DB and Slide the Window
     */
    private validateSession;
    signToken(sessionId: string, payload: any): string;
    logout(sessionId: string): Promise<void>;
    /**
     * Get all active devices for a user.
     */
    getActiveSessions(userId: string): Promise<{
        sessionId: string;
        device: any;
        loginAt: any;
        user: any;
    }[]>;
    /**
     * "Log me out of everywhere"
     */
    logoutAll(userId: string): Promise<void>;
    sendOTP(email: string): Promise<{
        success: boolean;
    }>;
    verifyOTP(email: string, code: string): Promise<{
        valid: boolean;
        error: string;
    } | {
        valid: boolean;
        error?: undefined;
    }>;
}
